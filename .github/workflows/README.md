# GitHub Actions å·¥ä½œæµè¯´æ˜

æœ¬é¡¹ç›®åŒ…å«å¤šä¸ªç‹¬ç«‹çš„å‘å¸ƒå·¥ä½œæµï¼Œæ”¯æŒå•ç‹¬å‘å¸ƒå„ä¸ªæ¨¡å—æˆ–é›†æˆå‘å¸ƒ BOMã€‚

## ğŸ“‹ å·¥ä½œæµåˆ—è¡¨

### 1. å•ç‹¬æ¨¡å—å‘å¸ƒ

- **publish-lumen-core.yml** - å‘å¸ƒ `lumen-core` æ¨¡å—
- **publish-lumen-transform.yml** - å‘å¸ƒ `lumen-transform` æ¨¡å—
- **publish-lumen-view.yml** - å‘å¸ƒ `lumen-view` æ¨¡å—
- **publish-lumen-compose.yml** - å‘å¸ƒ `lumen-compose` æ¨¡å—

### 2. é›†æˆå‘å¸ƒ

- **publish-lumen-bom.yml** - å‘å¸ƒ `lumen-bom`ï¼ˆé›†æˆæ‰€æœ‰æ¨¡å—ï¼‰

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å•ç‹¬å‘å¸ƒæ¨¡å—

1. è¿›å…¥ GitHub Actions é¡µé¢
2. é€‰æ‹©å¯¹åº”çš„å·¥ä½œæµï¼ˆå¦‚ `Publish lumen-core`ï¼‰
3. ç‚¹å‡» "Run workflow"
4. å¡«å†™å‚æ•°ï¼š
   - **version**: ç‰ˆæœ¬å·ï¼ˆå¦‚ `1.0.0`ï¼‰ï¼Œç•™ç©ºåˆ™è‡ªåŠ¨é€’å¢
   - **auto_increment**: æ˜¯å¦è‡ªåŠ¨é€’å¢ç‰ˆæœ¬ï¼ˆé»˜è®¤ `true`ï¼‰
   - **publish_to**: å‘å¸ƒç›®æ ‡ï¼ˆä»… `maven-central`ï¼‰

### é›†æˆå‘å¸ƒ BOM

1. é€‰æ‹© `Publish lumen-bom (Integrated)` å·¥ä½œæµ
2. ç‚¹å‡» "Run workflow"
3. å¡«å†™å‚æ•°ï¼š
   - **bom_version**: BOM ç‰ˆæœ¬å·ï¼ˆå¦‚ `1.0.0`ï¼‰ï¼Œç•™ç©ºåˆ™è‡ªåŠ¨é€’å¢
   - **core_version**: lumen-core ç‰ˆæœ¬ï¼ˆç•™ç©ºåˆ™ä½¿ç”¨ BOM ç‰ˆæœ¬ï¼‰
   - **transform_version**: lumen-transform ç‰ˆæœ¬ï¼ˆç•™ç©ºåˆ™ä½¿ç”¨ BOM ç‰ˆæœ¬ï¼‰
   - **view_version**: lumen-view ç‰ˆæœ¬ï¼ˆç•™ç©ºåˆ™ä½¿ç”¨ BOM ç‰ˆæœ¬ï¼‰
   - **compose_version**: lumen-compose ç‰ˆæœ¬ï¼ˆç•™ç©ºåˆ™ä½¿ç”¨ BOM ç‰ˆæœ¬ï¼‰
   - **auto_increment**: æ˜¯å¦è‡ªåŠ¨é€’å¢ BOM ç‰ˆæœ¬ï¼ˆé»˜è®¤ `true`ï¼‰
   - **publish_to**: å‘å¸ƒç›®æ ‡ï¼ˆä»… `maven-central`ï¼‰
     - Maven Central: å‘å¸ƒ BOM å’Œæ‰€æœ‰å­æ¨¡å—

## ğŸ“¦ ç‰ˆæœ¬ç®¡ç†

### ç‰ˆæœ¬è§„åˆ™ï¼ˆåŸºäºåˆ†æ”¯ï¼‰

ç‰ˆæœ¬è§„åˆ™æ ¹æ®å½“å‰åˆ†æ”¯è‡ªåŠ¨ç¡®å®šï¼š

- **main/master åˆ†æ”¯**ï¼š
  - é»˜è®¤èµ·å§‹ç‰ˆæœ¬ï¼š`0.0.1`
  - è‡ªåŠ¨é€’å¢ï¼š`0.0.1` â†’ `0.0.2` â†’ `0.0.3` â†’ ...
  
- **å¼€å‘åˆ†æ”¯ï¼ˆv1.0.0/developï¼‰**ï¼š
  - é»˜è®¤èµ·å§‹ç‰ˆæœ¬ï¼š`1.0.0`
  - è‡ªåŠ¨é€’å¢ï¼š`1.0.0` â†’ `1.0.1` â†’ `1.0.2` â†’ ...
  
- **å…¶ä»–åˆ†æ”¯**ï¼š
  - é»˜è®¤èµ·å§‹ç‰ˆæœ¬ï¼š`1.0.0`
  - è‡ªåŠ¨é€’å¢ï¼š`1.0.0` â†’ `1.0.1` â†’ `1.0.2` â†’ ...

### ç‰ˆæœ¬ä¼˜å…ˆçº§

æ¯ä¸ªæ¨¡å—çš„ç‰ˆæœ¬ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š
1. **æ‰‹åŠ¨è¾“å…¥çš„ç‰ˆæœ¬å·**ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼Œè¦†ç›–æ‰€æœ‰è§„åˆ™ï¼‰
2. **è‡ªåŠ¨é€’å¢çš„ç‰ˆæœ¬å·**ï¼ˆåŸºäºåˆ†æ”¯è§„åˆ™ï¼‰
3. **å½“å‰ `gradle.properties` ä¸­çš„ç‰ˆæœ¬å·**
4. **é»˜è®¤ç‰ˆæœ¬**ï¼ˆæ ¹æ®åˆ†æ”¯ï¼šmain=0.0.1ï¼Œå…¶ä»–=1.0.0ï¼‰

### è‡ªåŠ¨é€’å¢è§„åˆ™

- è‡ªåŠ¨é€’å¢ patch ç‰ˆæœ¬ï¼š`X.Y.Z` â†’ `X.Y.(Z+1)`
- æ”¯æŒæ‰‹åŠ¨æŒ‡å®šç‰ˆæœ¬å·è¦†ç›–è‡ªåŠ¨é€’å¢
- å¦‚æœå½“å‰ç‰ˆæœ¬ä¸ºç©ºï¼Œæ ¹æ®åˆ†æ”¯ä½¿ç”¨é»˜è®¤èµ·å§‹ç‰ˆæœ¬

## ğŸ”„ å·¥ä½œæµæµç¨‹

æ¯ä¸ªå·¥ä½œæµåŒ…å«ä»¥ä¸‹æ­¥éª¤ï¼š

1. **pre-check**: ç‰ˆæœ¬æ£€æŸ¥å’Œç¡®å®š
2. **build**: æ„å»ºå’Œæµ‹è¯•æ¨¡å—
3. **publish-maven-central**: å‘å¸ƒåˆ° Maven Centralï¼ˆå¦‚æœé€‰æ‹©ï¼‰
5. **summary**: å‘å¸ƒæ€»ç»“

## ğŸ“ å‘å¸ƒç¤ºä¾‹

### ç¤ºä¾‹ 1: main åˆ†æ”¯è‡ªåŠ¨é€’å¢å‘å¸ƒ

```
åˆ†æ”¯: main
å·¥ä½œæµ: Publish lumen-core
version: (ç•™ç©º)
auto_increment: true
publish_to: both
ç»“æœ: 0.0.1 â†’ 0.0.2 â†’ 0.0.3 â†’ ...
```

### ç¤ºä¾‹ 2: develop åˆ†æ”¯è‡ªåŠ¨é€’å¢å‘å¸ƒ

```
åˆ†æ”¯: develop
å·¥ä½œæµ: Publish lumen-view
version: (ç•™ç©º)
auto_increment: true
publish_to: maven-central
ç»“æœ: 1.0.0 â†’ 1.0.1 â†’ 1.0.2 â†’ ...
```

### ç¤ºä¾‹ 3: æ‰‹åŠ¨æŒ‡å®šç‰ˆæœ¬ï¼ˆè¦†ç›–åˆ†æ”¯è§„åˆ™ï¼‰

```
åˆ†æ”¯: main
å·¥ä½œæµ: Publish lumen-core
version: 2.0.0
auto_increment: false
publish_to: both
ç»“æœ: å‘å¸ƒ 2.0.0ï¼ˆå¿½ç•¥åˆ†æ”¯é»˜è®¤è§„åˆ™ï¼‰
```

### ç¤ºä¾‹ 4: é›†æˆå‘å¸ƒ BOMï¼Œå„æ¨¡å—ç‹¬ç«‹ç‰ˆæœ¬

```
å·¥ä½œæµ: Publish lumen-bom (Integrated)
bom_version: 1.2.0
core_version: 1.2.0
transform_version: 1.1.3
view_version: 1.0.5
compose_version: 1.0.2
auto_increment: false
publish_to: maven-central
```

### ç¤ºä¾‹ 5: é›†æˆå‘å¸ƒ BOMï¼Œç»Ÿä¸€ç‰ˆæœ¬

```
å·¥ä½œæµ: Publish lumen-bom (Integrated)
bom_version: 1.2.0
core_version: (ç•™ç©ºï¼Œä½¿ç”¨ BOM ç‰ˆæœ¬)
transform_version: (ç•™ç©ºï¼Œä½¿ç”¨ BOM ç‰ˆæœ¬)
view_version: (ç•™ç©ºï¼Œä½¿ç”¨ BOM ç‰ˆæœ¬)
compose_version: (ç•™ç©ºï¼Œä½¿ç”¨ BOM ç‰ˆæœ¬)
auto_increment: false
publish_to: maven-central
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å¹¶å‘æ§åˆ¶**: æ¯ä¸ªå·¥ä½œæµéƒ½æœ‰å¹¶å‘æ§åˆ¶ï¼ŒåŒä¸€åˆ†æ”¯çš„ç›¸åŒå·¥ä½œæµä¸ä¼šåŒæ—¶è¿è¡Œ
2. **ç‰ˆæœ¬å†²çª**: å¦‚æœæŒ‡å®šçš„ç‰ˆæœ¬å·²å­˜åœ¨ï¼Œå‘å¸ƒå¯èƒ½ä¼šå¤±è´¥
3. **ä¾èµ–å…³ç³»**: å‘å¸ƒ `lumen-view` æˆ– `lumen-compose` å‰ï¼Œç¡®ä¿ `lumen-core` å·²å‘å¸ƒ
4. **å‘å¸ƒç›®æ ‡**: æ‰€æœ‰æ¨¡å—ä»…å‘å¸ƒåˆ° Maven Central

## ğŸ”— ç›¸å…³é“¾æ¥

- [Maven Central](https://central.sonatype.com/)
- [ç‰ˆæœ¬ç®¡ç†æ–‡æ¡£](../VERSIONING.md)

