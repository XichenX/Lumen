# ç‰ˆæœ¬ç®¡ç†æŒ‡å—

æœ¬æ–‡æ¡£è¯´æ˜ Lumen çš„ç‰ˆæœ¬ç®¡ç†ç­–ç•¥å’Œè‡ªåŠ¨é€’å¢æœºåˆ¶ã€‚

## ğŸ¯ ç‰ˆæœ¬ç®¡ç†ç­–ç•¥

### ç‰ˆæœ¬å·æ ¼å¼

éµå¾ª [è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/) è§„èŒƒï¼š`ä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·`ï¼ˆå¦‚ `1.0.0`ï¼‰

- **ä¸»ç‰ˆæœ¬å·**ï¼šä¸å…¼å®¹çš„ API ä¿®æ”¹
- **æ¬¡ç‰ˆæœ¬å·**ï¼šå‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢
- **ä¿®è®¢å·**ï¼šå‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£

### åˆ†æ”¯ä¸ç‰ˆæœ¬å·å…³è”

ç‰ˆæœ¬å·ä¸å¼€å‘åˆ†æ”¯å…³è”ï¼š

- **main åˆ†æ”¯**ï¼šç¨³å®šç‰ˆæœ¬ï¼Œå¦‚ `1.0.0`
- **develop åˆ†æ”¯**ï¼šå¼€å‘ç‰ˆæœ¬ï¼Œå¦‚ `1.0.0/develop` â†’ åŸºç¡€ç‰ˆæœ¬ `1.0.0`

## ğŸš€ å‘å¸ƒæ–¹å¼

### æ–¹å¼ä¸€ï¼šè‡ªåŠ¨é€’å¢ç‰ˆæœ¬å·ï¼ˆæ¨èï¼‰

å½“ tag ç‰ˆæœ¬ä¸å½“å‰ä»£ç åº“ç‰ˆæœ¬ç›¸åŒæ—¶ï¼Œè‡ªåŠ¨é€’å¢ patch ç‰ˆæœ¬ï¼š

```bash
# å½“å‰ä»£ç åº“ç‰ˆæœ¬ï¼š1.0.0
# æ‰“ tagï¼šv1.0.0 æˆ– v1.0.0/develop
# è‡ªåŠ¨å‘å¸ƒç‰ˆæœ¬ï¼š1.0.1ï¼ˆè‡ªåŠ¨é€’å¢ï¼‰

git tag -a v1.0.0 -m "Release v1.0.0"
git push origin v1.0.0
```

**å·¥ä½œæµç¨‹ï¼š**
1. GitHub Actions æ£€æµ‹åˆ° tag `v1.0.0`
2. æå–åŸºç¡€ç‰ˆæœ¬å·ï¼š`1.0.0`
3. è¯»å–ä»£ç åº“å½“å‰ç‰ˆæœ¬ï¼š`1.0.0`
4. å‘ç°ç‰ˆæœ¬ç›¸åŒï¼Œè‡ªåŠ¨é€’å¢ï¼š`1.0.0` â†’ `1.0.1`
5. å‘å¸ƒ `1.0.1` ç‰ˆæœ¬

### æ–¹å¼äºŒï¼šæŒ‡å®šç‰ˆæœ¬å·

ç›´æ¥æŒ‡å®šè¦å‘å¸ƒçš„ç‰ˆæœ¬å·ï¼š

```bash
# æ‰“ tag æŒ‡å®šç‰ˆæœ¬
git tag -a v1.0.5 -m "Release v1.0.5"
git push origin v1.0.5

# æˆ–ä½¿ç”¨æ‰‹åŠ¨è§¦å‘ï¼ŒæŒ‡å®šç‰ˆæœ¬å·
# åœ¨ GitHub Actions ä¸­æ‰‹åŠ¨è§¦å‘ï¼Œè¾“å…¥ç‰ˆæœ¬å·ï¼š1.0.5
```

**å·¥ä½œæµç¨‹ï¼š**
1. GitHub Actions æ£€æµ‹åˆ° tag `v1.0.5`
2. æå–ç‰ˆæœ¬å·ï¼š`1.0.5`
3. ç›´æ¥ä½¿ç”¨è¯¥ç‰ˆæœ¬å·å‘å¸ƒ

### æ–¹å¼ä¸‰ï¼šåŸºäºåˆ†æ”¯çš„ç‰ˆæœ¬å·

åˆ›å»º develop åˆ†æ”¯æ—¶ï¼Œç‰ˆæœ¬å·è·Ÿç€åˆ†æ”¯èµ°ï¼š

```bash
# åˆ›å»º develop åˆ†æ”¯ï¼Œç‰ˆæœ¬å· 1.0.0
git checkout -b develop
# åœ¨ gradle.properties ä¸­è®¾ç½® VERSION_NAME=1.0.0
git add gradle.properties
git commit -m "chore: set version to 1.0.0 for develop branch"
git push origin develop

# åç»­åœ¨ develop åˆ†æ”¯ä¸Šæ‰“ tag
git tag -a v1.0.0/develop -m "Release v1.0.0 from develop"
git push origin v1.0.0/develop

# GitHub Actions ä¼šï¼š
# 1. æå–åŸºç¡€ç‰ˆæœ¬å·ï¼š1.0.0ï¼ˆå¿½ç•¥ /develop åç¼€ï¼‰
# 2. å¦‚æœå½“å‰ç‰ˆæœ¬æ˜¯ 1.0.0ï¼Œè‡ªåŠ¨é€’å¢ä¸º 1.0.1
# 3. å‘å¸ƒ 1.0.1 ç‰ˆæœ¬
```

## ğŸ“‹ ç‰ˆæœ¬å·æå–è§„åˆ™

### Tag æ ¼å¼æ”¯æŒ

æ”¯æŒä»¥ä¸‹ tag æ ¼å¼ï¼š

- `v1.0.0` â†’ ç‰ˆæœ¬å·ï¼š`1.0.0`
- `v1.0.0/develop` â†’ ç‰ˆæœ¬å·ï¼š`1.0.0`ï¼ˆå¿½ç•¥ `/develop` åç¼€ï¼‰
- `v1.0.0/main` â†’ ç‰ˆæœ¬å·ï¼š`1.0.0`ï¼ˆå¿½ç•¥ `/main` åç¼€ï¼‰
- `v2.1.3` â†’ ç‰ˆæœ¬å·ï¼š`2.1.3`

### è‡ªåŠ¨é€’å¢é€»è¾‘

1. **Tag ç‰ˆæœ¬ = å½“å‰ç‰ˆæœ¬**ï¼šè‡ªåŠ¨é€’å¢ patch ç‰ˆæœ¬
   - å½“å‰ï¼š`1.0.0`ï¼ŒTagï¼š`v1.0.0` â†’ å‘å¸ƒï¼š`1.0.1`
   - å½“å‰ï¼š`1.0.5`ï¼ŒTagï¼š`v1.0.5` â†’ å‘å¸ƒï¼š`1.0.6`

2. **Tag ç‰ˆæœ¬ â‰  å½“å‰ç‰ˆæœ¬**ï¼šä½¿ç”¨ Tag ç‰ˆæœ¬
   - å½“å‰ï¼š`1.0.0`ï¼ŒTagï¼š`v1.0.5` â†’ å‘å¸ƒï¼š`1.0.5`
   - å½“å‰ï¼š`1.0.0`ï¼ŒTagï¼š`v2.0.0` â†’ å‘å¸ƒï¼š`2.0.0`

## ğŸ”§ æ‰‹åŠ¨è§¦å‘å‘å¸ƒ

### åœ¨ GitHub Actions ä¸­æ‰‹åŠ¨è§¦å‘

1. è¿›å…¥ä»“åº“ â†’ **Actions** â†’ **Publish to Maven Central**
2. ç‚¹å‡» **Run workflow**
3. é€‰æ‹©é€‰é¡¹ï¼š
   - **Version**ï¼šæŒ‡å®šç‰ˆæœ¬å·ï¼ˆå¦‚ `1.0.5`ï¼‰ï¼Œç•™ç©ºåˆ™ä½¿ç”¨å½“å‰ç‰ˆæœ¬
   - **Auto increment**ï¼šå‹¾é€‰åˆ™è‡ªåŠ¨é€’å¢ patch ç‰ˆæœ¬

### ç¤ºä¾‹

**åœºæ™¯ 1ï¼šæ‰‹åŠ¨æŒ‡å®šç‰ˆæœ¬å·**
- Version: `1.0.5`
- Auto increment: ä¸å‹¾é€‰
- ç»“æœï¼šå‘å¸ƒ `1.0.5`

**åœºæ™¯ 2ï¼šè‡ªåŠ¨é€’å¢**
- Version: ç•™ç©º
- Auto increment: å‹¾é€‰
- å½“å‰ç‰ˆæœ¬ï¼š`1.0.0`
- ç»“æœï¼šå‘å¸ƒ `1.0.1`

**åœºæ™¯ 3ï¼šä½¿ç”¨å½“å‰ç‰ˆæœ¬**
- Version: ç•™ç©º
- Auto increment: ä¸å‹¾é€‰
- å½“å‰ç‰ˆæœ¬ï¼š`1.0.0`
- ç»“æœï¼šå‘å¸ƒ `1.0.0`

## ğŸ“ æœ€ä½³å®è·µ

### 1. å¼€å‘æ–°åŠŸèƒ½

```bash
# 1. åˆ›å»º develop åˆ†æ”¯
git checkout -b develop

# 2. æ›´æ–°ç‰ˆæœ¬å·ï¼ˆå¦‚ 1.0.0 -> 1.1.0ï¼‰
# ç¼–è¾‘ gradle.properties: VERSION_NAME=1.1.0
git add gradle.properties
git commit -m "chore: bump version to 1.1.0 for new features"
git push origin develop

# 3. å¼€å‘å®Œæˆåï¼Œæ‰“ tag å‘å¸ƒ
git tag -a v1.1.0/develop -m "Release v1.1.0"
git push origin v1.1.0/develop
# å¦‚æœå½“å‰ç‰ˆæœ¬æ˜¯ 1.1.0ï¼Œä¼šè‡ªåŠ¨å‘å¸ƒ 1.1.1
```

### 2. ä¿®å¤ Bug

```bash
# 1. åœ¨ main åˆ†æ”¯ä¿®å¤
git checkout main

# 2. æ‰“ tagï¼ˆè‡ªåŠ¨é€’å¢ patch ç‰ˆæœ¬ï¼‰
git tag -a v1.0.0 -m "Bug fix release"
git push origin v1.0.0
# å¦‚æœå½“å‰ç‰ˆæœ¬æ˜¯ 1.0.0ï¼Œä¼šè‡ªåŠ¨å‘å¸ƒ 1.0.1
```

### 3. é‡å¤§ç‰ˆæœ¬æ›´æ–°

```bash
# 1. æ›´æ–°ç‰ˆæœ¬å·
# ç¼–è¾‘ gradle.properties: VERSION_NAME=2.0.0
git add gradle.properties
git commit -m "chore: bump version to 2.0.0"
git push origin main

# 2. æ‰“ tagï¼ˆä½¿ç”¨æ–°ç‰ˆæœ¬å·ï¼‰
git tag -a v2.0.0 -m "Major release v2.0.0"
git push origin v2.0.0
# å› ä¸ºç‰ˆæœ¬ä¸åŒï¼Œç›´æ¥å‘å¸ƒ 2.0.0
```

## ğŸ” ç‰ˆæœ¬å·æ£€æŸ¥

### æŸ¥çœ‹å½“å‰ç‰ˆæœ¬

```bash
# æŸ¥çœ‹ gradle.properties ä¸­çš„ç‰ˆæœ¬å·
grep VERSION_NAME gradle.properties

# æˆ–æŸ¥çœ‹å·²å‘å¸ƒçš„ç‰ˆæœ¬
# Maven Central: https://repo1.maven.org/maven2/io/github/xichenx/
# JitPack: https://jitpack.io/#XichenX/Lumen
```

### ç‰ˆæœ¬å·å†å²

ç‰ˆæœ¬å·å˜æ›´ä¼šè‡ªåŠ¨æäº¤åˆ°ä»£ç åº“ï¼Œå¯ä»¥é€šè¿‡ git å†å²æŸ¥çœ‹ï¼š

```bash
git log --oneline --grep="bump version" -- gradle.properties
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å‘å¸ƒæŒ‡å—](PUBLISH.md)
- [å¿«é€Ÿå¼€å§‹](QUICK_START.md)

